# ERC1400 - Contracts

This project contains ERC1400 security token smart contracts as well as the tests files and testing environment.

## Quick start

Test the smart contract, by running the following commands:
```
$ git clone https://gitlab.com/ConsenSys/client/fr/dauriel/securities-smart-contracts.git
$ cd securities-smart-contracts
$ make init
$ make coverage
```
Prerequisites: please make sure you installed "truffle", "make", "g++"" on your device.

## Install your own personal blockchain for Ethereum development.

```
$ yarn global add ganache-cli
```
or
```
$ npm i ganache-cli
```

## Setup environment variables

Before deploying the contract you need to generate and fill the file containing all environment variables ('.env' file).

Generate the '.env' file with the following command:
```
$ node setup.js
```

Open the '.env' Replace the fake variable values. Here's an example '.env' file:
```
$ INFURA_API_KEY=a420aed2329e49f7ab09f2ba1efb38fc
$ SOLIDITY_COVERAGE=
$ MNEMONIC=brain surround have swap horror body response double fire dumb bring hazard
```

INFURA_API_KEY can be generated by creating an account on https://infura.io/

There are 2 options to get MNEMONIC:

Option 1 [RECOMMENDED]: MNEMONIC can be filled by re-using the wallet generated by ganache:
```
$ ganache-cli
```
This option is recommended since the wallet will be pre-loaded with ETH for tests on ganache.

Option 2: MNEMONIC can also be obtained by generating 12 random words on https://iancoleman.io/bip39/ (BIP39 Mnemonic).


## Send ETH to the address corresponding to your MNEMONIC

There are 2 options to recover the ETH address corresponding to your MNEMONIC:

Option 1 [RECOMMENDED]: Launch ganache to generate your wallet. It contains 10 pre-loaded accounts. Your can take account (0) as address:
```
$ ganache-cli
```
It is already loaded with 100 ETH, so you have nothing to do.

Option 2:
Discover the wallet associated to your MNEMONIC on https://www.myetherwallet.com/#view-wallet-info > Mnemonic phrase.
Send ETH to the first address of this wallet in order to be able to send transactions with it.

## Deploy contract on ganache

Deploy the contract by running the migration scripts:
```
$ truffle migrate
```

## Deploy contract on ropsten

Start building the contract (this generates the concatenated solidity files required to publish the contract on blockchan explorers like Etherscan, Kaleido, etc.):
```
$ npm run build
```

Deploy the contract by running the migration scripts:
```
$ truffle migrate --network ropsten
```

Export contract parameters in export.txt file:
```
$ node export.js
```
